<!-- Main wrapper  -->
<div id="main-wrapper">
  <app-header></app-header>
  <app-sidebar></app-sidebar>
  <!-- Page wrapper  -->
  <div class="page-wrapper">
    <!-- Bread crumb -->
    <div class="row page-titles">
      <div class="col-md-5 align-self-center">
        <h3 class="text-primary">Campaign(s)</h3> </div>
      <div class="col-md-7 align-self-center">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a routerLink="/dashboard">Home</a></li>
          <li class="breadcrumb-item active">Campaign(s)</li>
        </ol>
      </div>
    </div>
    <!-- End Bread crumb -->
    <!-- Start Page Body Main Container -->
    <div class="container-fluid">
      <div class="row">
        <div class="col-lg-12">
          <div class="card">
            <div class="card-title">
              <h4>Campaign(s)</h4>
              <div *ngIf="this.errFlg" class="alert alert-danger alert-dismissable">
                <a href="#" class="close" data-dismiss="alert" aria-label="close" (click)="closeDiv();">&times;</a>
                {{this.errString}}
              </div>
              <button type="button" class="btn btn-success btn-xs m-b-10 m-l-5" id="add-campaign" (click)="showAddForm();">
                <i class="fa fa-{{addCampaign === true ? 'minus': 'plus'}}"></i>
              </button>
              <input type="text" class="form-control input-sm" id="search-box" [(ngModel)]="term" placeholder="Search..">
            </div>
            <div class="container-fluid" *ngIf="addCampaign">
              <div class="panel panel-default">
                <div class="panel-heading">
                  <span *ngIf="isEdit">Edit Campaign</span>
                  <span *ngIf="!isEdit">Add Campaign</span>
                </div>
                <div class="panel-body">
                  <form [formGroup]="saveCampaignForm" (ngSubmit)="onSubmit()" class="campaign-form">
                    <div class="form-group">
                      <label for="campaign_name">Campaign Name</label>
                      <input type="text" class="form-control" formControlName="campaign_name" placeholder="Campaign Name" id="campaign_name" [class.has-error-custom]="saveCampaignForm.controls.campaign_name.invalid && saveCampaignForm.controls.campaign_name.touched">
                    </div>
                    <div *ngIf="saveCampaignForm.controls.campaign_name.invalid && saveCampaignForm.controls.campaign_name.touched" class="error-alert">
                      <div *ngIf="saveCampaignForm.controls.campaign_name.pristine;else campaignNameErrorElse">
                        Campaign name is required!
                      </div>
                      <ng-template #campaignNameErrorElse>Campaign name should be at most 100 characters long.</ng-template>
                    </div>
                    <div class="form-group">
                      <label for="domain_name">Domain Name</label>
                      <input type="url" class="form-control" formControlName="domain_name"  placeholder="Domain Name" id="domain_name" [class.has-error-custom]="saveCampaignForm.controls.domain_name.invalid && saveCampaignForm.controls.domain_name.touched">
                    </div>
                    <div *ngIf="saveCampaignForm.controls.domain_name.invalid && saveCampaignForm.controls.domain_name.touched" class="error-alert">
                      <div *ngIf="saveCampaignForm.controls.domain_name.pristine;else domainlErrorElse">
                        Domain name is required!
                      </div>
                      <ng-template #domainlErrorElse>Domain name should look like http://example.com</ng-template>
                    </div>
                    <div class="form-group">
                      <label for="styles">Select style</label>
                      <select name="styles" id="styles" class="form-control" formControlName="styles" required [class.has-error-custom]="saveCampaignForm.controls.styles.invalid && saveCampaignForm.controls.styles.touched">
                        <option value="">-- SELECT STYLE --</option>
                        <option value="rounded">Rounded Corner</option>
                        <option value="square">Square Corner</option>
                      </select>
                    </div>
                    <div *ngIf="saveCampaignForm.controls.styles.invalid && saveCampaignForm.controls.styles.touched" class="error-alert">
                      Style is required!
                    </div>
                    <div class="form-group">
                      <label for="loop">Loop sticky reviews</label>
                      <mat-radio-group formControlName="loop" id="loop" [(ngModel)]="loop_reviews_value">
                        &nbsp;<mat-radio-button [value]="'1'"> Yes</mat-radio-button>
                        &nbsp;<mat-radio-button [value]="'0'"> No</mat-radio-button>
                      </mat-radio-group>
                    </div>
                    <div class="form-group">
                      <label for="delay_before_start">Delay Before Start (in seconds)</label>
                      <input type="text" class="form-control" formControlName="delay_before_start" placeholder="The amount of time you mention here, your webpage will wait for this much time long before showing sticky reviews." id="delay_before_start" [class.has-error-custom]="saveCampaignForm.controls.delay_before_start.invalid && saveCampaignForm.controls.delay_before_start.touched">
                    </div>
                    <div *ngIf="saveCampaignForm.controls.delay_before_start.invalid && saveCampaignForm.controls.delay_before_start.touched" class="error-alert">
                      <div *ngIf="saveCampaignForm.controls.delay_before_start.pristine;else delayBeforeStartErrorElse">
                        Delay before start should be numeric!
                      </div>
                      <ng-template #delayBeforeStartErrorElse>Delay before start can not be negative number.</ng-template>
                    </div>
                    <div class="form-group">
                      <label for="delay">Interval Between Reviews (in seconds)</label>
                      <input type="text" class="form-control" formControlName="delay" placeholder="Each reviews are going to show for the amount of time you metion here before next revies slides in." id="delay" [class.has-error-custom]="saveCampaignForm.controls.delay.invalid && saveCampaignForm.controls.delay.touched">
                    </div>
                    <div *ngIf="saveCampaignForm.controls.delay.invalid && saveCampaignForm.controls.delay.touched" class="error-alert">
                      <div *ngIf="saveCampaignForm.controls.delay.pristine;else intervalErrorElse">
                        Interval between reviews should be numeric!
                      </div>
                      <ng-template #intervalErrorElse>Interval between reviews can not be negative number.</ng-template>
                    </div>
                    <div class="row" style="margin-bottom: 1% !important;">
                      <div class="col-4">
                        <mat-slide-toggle formControlName="branding" (change)="handleBranding($event)">Branding</mat-slide-toggle>
                      </div>
                      <div class="col-8" *ngIf="selectBranding">
                        <select formControlName="branding_id" id="branding_id" class="form-control" [class.has-error-custom]="saveCampaignForm.controls.branding_id.invalid && saveCampaignForm.controls.branding_id.touched">
                          <option value="">---SELECT BRANDING---</option>
                          <option *ngFor="let brand of brandingArr" value="{{brand.id}}">{{brand.brand_name}}</option>
                        </select>
                      </div>
                    </div>
                    <div class="row" style="margin-bottom: 1% !important;">
                      <div class="col-4">
                        <mat-slide-toggle formControlName="exit_pop_up" (change)="handleExitPopUp($event)">Exit Pop Up</mat-slide-toggle>
                      </div>
                      <div class="col-8" *ngIf="selectExitPopUp">
                        <select formControlName="exit_pop_up_ids_arr" id="exit_pop_up_ids_arr" class="form-control" [class.has-error-custom]="saveCampaignForm.controls.exit_pop_up_ids_arr.invalid && saveCampaignForm.controls.exit_pop_up_ids_arr.touched">
                          <option value="">---SELECT EXIT POP UP---</option>
                          <option *ngFor="let popup of exitPopUpsList" value="{{popup.id}}">{{ popup.name }}</option>
                        </select>
                      </div>
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">
                      <span *ngIf="savingData"><i class="fa fa-circle-o-notch fa-spin"></i> Processing....</span>
                      <span *ngIf="!savingData">Save</span>
                    </button>
                  </form>
                </div>
              </div>
            </div>
            <div class="card-body">
              <div class="table-responsive">
                <table class="table table-striped table-bordered">
                  <thead>
                  <tr>
                    <th>#</th>
                    <th>Name</th>
                    <th>Domain</th>
                    <th>Style</th>
                    <th>Delay</th>
                    <th>Delay Before Start</th>
                    <th>Loop</th>
                    <th>Branding</th>
                    <th>Exit pop up</th>
                    <th>Created</th>
                    <th>Last updated</th>
                    <th>status</th>
                    <th>Action(s)</th>
                  </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let campaign of campaignListArray| filter: term | paginate: { itemsPerPage: paginate, currentPage: p }; let i = index">
                      <th scope="row">{{i+1}}</th>
                      <td>{{campaign.campaign_name}}</td>
                      <td>
                        <span class="badge badge-primary">{{campaign.domain_name}}</span>
                        <button class="btn btn-xs btn-outline" type="button" ngxClipboard [cbContent]="campaign.domain_name" tooltip="Copy"><i class="fa fa-copy" aria-hidden="true"></i></button>
                      </td>
                      <td>{{ campaign.styles }}
                        <button type="button" class="btn btn-link" (click)="showDemoStyle(campaign.styles, campaign.branding, campaign.branding_id, campaign.delay)">
                          <i class="fa fa-question-circle" aria-hidden="true"></i>
                        </button>
                      </td>
                      <td>{{ campaign.delay / 1000 }} seconds</td>
                      <td>{{ campaign.delay_before_start / 1000 }} seconds</td>
                      <td>{{ campaign.loop === '0' ? 'No' : 'Yes'  }}</td>
                      <td *ngIf="campaign.branding === 1"><a routerLink="/branding/{{campaign.branding_id}}">Yes</a></td>
                      <td *ngIf="campaign.branding === 0">No</td>
                      <td>{{ campaign.exit_pop_up === '1' ? 'Yes' : 'No' }}</td>
                      <td>{{campaign.created_at | date: 'MMM d, y, h:mm:ss a'}}</td>
                      <td>{{campaign.updated_at | date: 'MMM d, y, h:mm:ss a'}}</td>
                      <td *ngIf="campaign.is_active == 0"><button class="btn btn-xs badge badge-success" type="button" (click)="changeStatus(campaign.id)">Active</button></td>
                      <td *ngIf="campaign.is_active == 1"><button class="btn btn-xs badge badge-danger" type="button" (click)="changeStatus(campaign.id)">Inactive</button></td>
                      <td>
                        <button type="button" class="btn btn-primary btn-xs m-b-10 m-l-5" (click)="editRecord(campaign)" tooltip="Edit Record"><i class="fa fa-edit"></i></button>
                        <button type="button" class="btn btn-danger btn-xs m-b-10 m-l-5" (click)="deleteRecordConfirm(campaign.id)" tooltip="Delete Record"><i class="fa fa-trash"></i></button>
                        <button type="button" class="btn btn-info btn-xs m-b-10 m-l-5" (click)="showAssignStickyReviews($event, campaign)" tooltip="Assign sticky reviews">
                          <i class="fa fa-paperclip" aria-hidden="true"></i> {{ assignSticky === campaign.id && toggleSticky === true ? 'save' : 'Sticky Reviews' }}
                        </button>
                        <div *ngIf="assignSticky === campaign.id && toggleSticky" id="mat_select_multi_{{ campaign.id }}">
                          <span class="tipnote"><i class="fa fa-lightbulb-o" aria-hidden="true"></i> Tip: after selecting the values click on save button to save the value</span>
                          <mat-form-field>
                            <mat-select placeholder="Sticky Reviews" multiple (selectionChange)="handleStickySelect($event.value, campaign.id)" [(ngModel)]="campaign.sticky_reviews" [compareWith]="compareObj">
                              <mat-option *ngFor="let stickyReview of stickyReviewListData" [value]="stickyReview.id">
                                <div *ngIf="!stickyReview.tags">{{ stickyReview.name }}</div>
                                <div *ngIf="stickyReview.tags">{{stickyReview.name}} <span class="label label-success arrowed"> {{ stickyReview.tags }}</span></div>
                              </mat-option>
                            </mat-select>
                          </mat-form-field>
                        </div>
                        <button type="button" class="btn btn-dark btn-outline m-b-10 m-l-5" (click)="showCodeSnippet(campaign, templateShowCode)" tooltip="Show Code Snippet">
                          <i class="fa fa-code"></i>
                        </button>
                      </td>
                    </tr>
                  </tbody>
                  <pagination-controls (pageChange)="p = $event" class="globalPagination"></pagination-controls>
                </table>
                <!--show embeded code modal start-->
                <ng-template #templateShowCode>
                  <div class="modal-header">
                    <h4 class="modal-title pull-left">Copy Code Snippet</h4>
                    <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <div class="row">
                      <div class="col-sm-10 col-md-10 col-lg-10 col-xl-10">
                        <pre><code highlight [textContent]="code"></code></pre>
                      </div>
                      <div class="col-sm-2 col-md-2 col-lg-2 col-xl-2">
                        <button type="button" class="btn btn-primary btn-xs" ngxClipboard [cbContent]="code" tooltip="Copy"><i class="fa fa-clipboard" aria-hidden="true"></i></button>
                      </div>
                    </div>

                  </div>
                </ng-template>
                <!--show embeded code modal end-->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!--pop up type rounded corner start-->
    <div *ngIf="roundedCornerFlg" class="animated fadeInUp" id="ajRy2fZIho1o2fZIsuS9_0">
      <div class="ajRy3zjZho1o3zjZsuS9_0 ajRy2riIho1o2riIsuS9_0">
        <div class="ajRy1JYFho1o1JYFsuS9_0">
          <img src="https://firebasestorage.googleapis.com/v0/b/proof-f6589.appspot.com/o/maps2%2Fc6fcf3d628ea3149313dfba0fa684a10.png.png?alt=media">
        </div>
        <div class="ajRy2EbCho1o2EbCsuS9_0">
          <div class="ajRy2AUlho1o2AUlsuS9_0">A Marketer from Tier5, USA</div>
          <div class="ajRy13BWho1o13BWsuS9_0">Recently signed up for Evenmorevago</div>
          <div class="ajRy2PlWho1o2PlWsuS9_0">3 hours ago</div>
          <div class="ajRy3eNuho1o3eNusuS9_0" *ngIf="isBranded"><!---->
            <i><svg width="7" height="13" viewBox="0 0 7 13" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M4.127.496C4.51-.12 5.37.356 5.16 1.07L3.89 5.14H6.22c.483 0 .757.616.464 1.044l-4.338 6.34c-.407.595-1.244.082-1.01-.618L2.72 7.656H.778c-.47 0-.748-.59-.48-1.02L4.13.495z" fill="#F6A623"></path><path fill="#FEF79E" d="M4.606.867L.778 7.007h2.807l-1.7 5.126 4.337-6.34H3.16"></path></g></svg></i>
            <span>by</span> <a class="ajRy12wMho1o12wMsuS9_0" href="{{brandDetails[0].url}}" target="_blank">{{brandDetails[0].brand_name}}</a>
          </div>
          <div class="ratings">
            <span class="fa fa-star checked"></span>
            <span class="fa fa-star checked"></span>
            <span class="fa fa-star checked"></span>
            <span class="fa fa-star"></span>
            <span class="fa fa-star"></span>
          </div>
        </div>
        <div class="ajRy1N_Eho1o1N_EsuS9_0" (click)="closePopUp('rounded')">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm4.597 17.954l-4.591-4.55-4.555 4.596-1.405-1.405 4.547-4.592-4.593-4.552 1.405-1.405 4.588 4.543 4.545-4.589 1.416 1.403-4.546 4.587 4.592 4.548-1.403 1.416z"></path></svg>
        </div>
      </div>
    </div>
    <!--pop up type rounded corner end-->

    <!--pop up square corner start-->
    <div *ngIf="squareCornerFlg" class="animated fadeInUp" id="ajRy2fZIho1o2fZIsuS9_01">
      <div class="ajRy3zjZho1o3zjZsuS9_0 ajRy2riIho1o2riIsuS9_0">
        <div class="ajRy1JYFho1o1JYFsuS9_0">
          <img src="https://firebasestorage.googleapis.com/v0/b/proof-f6589.appspot.com/o/maps2%2Fc6fcf3d628ea3149313dfba0fa684a10.png.png?alt=media">
        </div>
        <div class="ajRy2EbCho1o2EbCsuS9_0">
          <div class="ajRy2AUlho1o2AUlsuS9_0">A Marketer from Tier5, USA</div>
          <div class="ajRy13BWho1o13BWsuS9_0">Recently signed up for Evenmorevago</div>
          <div class="ajRy2PlWho1o2PlWsuS9_0">3 hours ago</div>
          <div class="ajRy3eNuho1o3eNusuS9_0" *ngIf="isBranded"><!---->
            <i><svg width="7" height="13" viewBox="0 0 7 13" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M4.127.496C4.51-.12 5.37.356 5.16 1.07L3.89 5.14H6.22c.483 0 .757.616.464 1.044l-4.338 6.34c-.407.595-1.244.082-1.01-.618L2.72 7.656H.778c-.47 0-.748-.59-.48-1.02L4.13.495z" fill="#F6A623"></path><path fill="#FEF79E" d="M4.606.867L.778 7.007h2.807l-1.7 5.126 4.337-6.34H3.16"></path></g></svg></i>
            <span>by</span> <a class="ajRy12wMho1o12wMsuS9_0" href="{{brandDetails[0].url}}" target="_blank">{{brandDetails[0].brand_name}}</a>
          </div>
          <div class="ratings">
            <span class="fa fa-star checked"></span>
            <span class="fa fa-star checked"></span>
            <span class="fa fa-star checked"></span>
            <span class="fa fa-star"></span>
            <span class="fa fa-star"></span>
          </div>
        </div>
        <div class="ajRy1N_Eho1o1N_EsuS9_0" (click)="closePopUp('square')">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm4.597 17.954l-4.591-4.55-4.555 4.596-1.405-1.405 4.547-4.592-4.593-4.552 1.405-1.405 4.588 4.543 4.545-4.589 1.416 1.403-4.546 4.587 4.592 4.548-1.403 1.416z"></path></svg>
        </div>
      </div>
    </div>
    <!--pop up square corner end-->
    <!-- End Page Body Main Container -->
    <app-footer></app-footer>
  </div>
  <!-- End Page wrapper  -->
</div>
<!-- End Wrapper -->
