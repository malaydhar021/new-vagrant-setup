<div class="mainBox stickyMain">
  <header class="mainBoxHeader">
    <div class="mainBoxHeaderLeft">
      <button type="button" class="addReview" (click)="onAddStickyReview()">
        <img src="../../../../assets/images/addIcon.png" alt=""> Add Review
      </button>
    </div>
    <div class="mainBoxHeaderRight">
      <input type="text" placeholder="Search ..." [(ngModel)]="keyword">
    </div>
  </header>
  <div class="dataTableArea">
    <div *ngIf="successMessage !== null">{{ successMessage }}</div>
    <div *ngIf="(isDeleting && errorMessage !== null)">{{ errorMessage }}</div>
    <div class="table table-col-4">
      <ul class="thead">
        <li>REVIEWS</li>
        <li>STAR RATING</li>
        <li>CREATED DATE</li>
        <li>ACTION(S)</li>
      </ul>
      <div class="tbody">
        <ng-scrollbar [compact]="true" *ngIf="reviews.length > 0; else noRecords">
          <ul>
            <li class="row" *ngFor="let review of reviews">
              <div class="rowContainer">
                <div class="tcol">
                  <div class="userImg">
                    <img src="{{ review.image_url }}" alt="" class="sticky-review-image">
                  </div>
                  <div class="userReview">
                    <h2>{{ review.name }} <span class="greenTag" *ngIf="review.tags !== null">{{ review.tags }}</span></h2>
                    <p>
                      {{ review.description }}
                    </p>
                  </div>
                </div>
                <div class="tcol">
                  <div class="rating">
                    <bar-rating [(rate)]="review.rating" [max]="5" [theme]="'default'" [readOnly]="true"></bar-rating>
                  </div>
                </div>
                <div class="tcol">
                  <p>{{ review.created_at | date : 'medium' }}</p>
                </div>
                <div class="tcol">
                  <a (click)="onEditStickyReview(review)" class="edit"><img src="../../../../assets/images/icon_edit.png" alt=""></a>
                  <a (click)="onDeleteStickyReview(review.id)" class="delete"><img src="../../../../assets/images/icon_delete_green.png" alt=""></a>
                </div>
              </div>
            </li>                
          </ul>
        </ng-scrollbar>
        <ng-template #noRecords>
            <ul>
                <li class="row">
                  <p class="no-records">Sorry no sticky reviews found !</p>
                </li>
            </ul>
        </ng-template>
      </div>
    </div>
    
  </div>
  
</div>
 
<!-- Modal form for add / edit a sticky review -->
<ngx-smart-modal #modal1 identifier="modal1" class="sr-modal">
  <div class="sr-modal-container">
    <div class="sr-modal-header">
      <h2>
          Add Sticky Review(s)
      </h2>
    </div>
    <div class="sr-modal-body">
      <div class="sr-form">
        <div *ngIf="errorMessage !== null">{{ errorMessage }}</div>
        <form [formGroup]="form" (ngSubmit)="onSubmit()">
          <div class="sr-form-content">
            <ng-scrollbar [compact]="true" class="formScroll">
              <div class="sr-form-row">
                <div class="sr-form-cell-small">
                  <label>Review Link Name</label>
                  <div class="sr-form-field">
                    <input type="text" class="sr-form-ctrl" [ngClass]="{error: isSubmitted && getFormControls.srName.errors}" formControlName="srName">
                    <div class="error-msg" *ngIf="(
                      isSubmitted 
                      && getFormControls.srName.errors !== null 
                      && getFormControls.srName.errors.required)">
                      Review link name is required
                    </div>
                    <div class="error-msg" *ngIf="(
                      isSubmitted 
                      && getFormControls.srName.errors !== null 
                      && getFormControls.srName.errors.maxlength)">
                      Review link name should be maximum 25 characters
                    </div>
                  </div>
                </div>
                <div class="sr-form-cell-small">
                  <label>Tags (optional)<img src="../../../../assets/images/icon_info2.png" class="infos_imgs" alt="infos"></label>
                  <div class="sr-form-field">
                    <input type="text" class="sr-form-ctrl" formControlName="srTags">
                  </div>
                </div>
              </div>              
              <div class="sr-form-row">
                <div class="sr-form-cell-small rating_modals">
                  <label>Rate your review</label>
                  <bar-rating [(rate)]="rate" [max]="5" [theme]="'default'" formControlName="srRating"></bar-rating>
                  <bar-rating [(rate)]="rate" [max]="4" [theme]="'default'" formControlName="srRating"></bar-rating>
                  <bar-rating [(rate)]="rate" [max]="3" [theme]="'default'" formControlName="srRating"></bar-rating>
                  <bar-rating [(rate)]="rate" [max]="2" [theme]="'default'" formControlName="srRating"></bar-rating>
                  <bar-rating [(rate)]="rate" [max]="1" [theme]="'default'" formControlName="srRating"></bar-rating>
                  <div class="error-msg" *ngIf="(
                    isSubmitted 
                    && getFormControls.srRating.errors !== null 
                    && getFormControls.srRating.errors.required)">
                    Review rating is required
                  </div>
                </div>
                <div class="sr-form-cell-small">
                  <label>Select Date and Time (Optional)</label>
                  <div class="sr-form-field">
                    <input [owlDateTime]="dt1" [owlDateTimeTrigger]="dt1" class="sr-form-ctrl dateTime" formControlName="srDateTime">
                  </div>
                  <owl-date-time #dt1></owl-date-time>

                  <label style="margin-top: 20px;">Select Review Type:</label>
                  <div class="sr-form-field">
                    <select class="sr-form-ctrl">
                      <option>Textual</option>
                      <option>Video</option>
                      <option>Audio</option>
                    </select>
                  </div>

                </div>
              </div>
              <div class="text_review">
                <div class="sr-form-row">
                  <div class="sr-form-cell">
                    <label>Description</label>
                    <div class="sr-form-field">
                      <textarea class="sr-form-ctrl description_textarea" [ngClass]="{error: isSubmitted && getFormControls.srComment.errors}" formControlName="srComment"></textarea>
                      <div class="error-msg" *ngIf="(
                        isSubmitted 
                        && getFormControls.srComment.errors !== null 
                        && getFormControls.srComment.errors.required)">
                        Review is required
                      </div>
                      <div class="error-msg" *ngIf="(
                        isSubmitted 
                        && getFormControls.srComment.errors !== null 
                        && getFormControls.srComment.errors.maxlength)">
                        Review should be maximum 80 characters
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="video_review">
                <div class="sr-form-row">
                  <div class="sr-form-cell">
                    <label>Upload your video file</label>
                    <div class="sr-form-field">
                      
                      <div class="box">
                        <input type="file" name="file-7[]" id="file-7" class="inputfile inputfile-6 hidden" data-multiple-caption="{count} files selected" multiple />
                        <label for="file-7" class="upload_btns" style="height: 40px;"><span></span> <strong style="float: left;" class="left_btns"><img src="../../../../assets/images/icon_video_2.png" class="video_imgs" alt="infos"> Choose a file&hellip;</strong></label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="audio_review">
                <div class="sr-form-row">
                  <div class="sr-form-cell">
                    <label>Upload your audio file</label>
                    <div class="sr-form-field">
                      <div class="box">
                        <input type="file" name="file-7[]" id="file-7" class="inputfile inputfile-6 hidden" data-multiple-caption="{count} files selected" multiple />
                        <label for="file-7" class="upload_btns" style="height: 40px;"><span></span> <strong style="float: left;" class="left_btns"><img src="../../../../assets/images/icon_audio_2.png" class="audio_imgs" alt="infos"> Choose a file&hellip;</strong></label>
                      </div>  
                    </div>
                  </div>
                </div>
              </div>

                <div class="sr-form-row">
                  <div class="sr-form-cell">
                    <label>Upload an image</label>
                    <div class="sr-form-field">
                      <div class="sr-form-ctrl inputFile">
                        <input type="file" (change)="onChangeFile($event)" formControlName="srImage" [ngClass]="{error: isSubmitted && getFormControls.srImage.errors}">
                        <div class="choseFileArea">
                          <div class="fileImg">
                            <img src="../../../../assets/images/icon_upload_photo.png" alt="">
                          </div>
                          <p>
                            <span>{{choseFileCtrl}}</span>{{fileName}}
                          </p>
                        </div>
                        <!-- <div class="figureUpld"></div> -->
                      </div>
                    </div>
                    <div class="error-msg" *ngIf="(
                      isSubmitted 
                      && getFormControls.srImage.errors !== null 
                      && getFormControls.srImage.errors.required)">
                      Image is required
                    </div>
                    <div class="error-msg" *ngIf="(
                      isSubmitted 
                      && getFormControls.srImage.errors !== null 
                      && getFormControls.srImage.errors.invalidFileType)">
                      Invalid file type. File should be an image
                    </div>
                    <div class="error-msg" *ngIf="(
                      isSubmitted 
                      && getFormControls.srImage.errors !== null 
                      && getFormControls.srImage.errors.invalidFileSize)">
                      Invalid image size
                    </div>
                  </div>
                </div>
            </ng-scrollbar>
          </div>

          <div class="sr-form-row">
            <div class="sr-form-cell">
              <button class="button-submit" type="submit">
                <img src="../../../../assets/images/addIcon.png" alt=""> Save Reviews
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
  <!-- <button (click)="myModal.close()">Close</button> -->
</ngx-smart-modal>
<!-- Modal ends -->

<!-- Loader -->
<div class="loaderOuter" *ngIf="loader">
  <div class="loaderContainer">
      <div class="loader">
          <img src="../../../../assets/images/face_icon.png" alt="">
      </div>
      <div class="loaderShadow"></div>
  </div>
</div>
